<?php//require_once(ROOT_DIR."/classes/entities/band.php");class PlanetInterface extends BasicInterface {		public function __construct($db = null) {		parent::__construct($db);	}		public function getPlayerByPlanet($data)	{		$q = "Select pl_spieler from planeten where pl_galaxie = ".$data->galaxy." AND pl_system =  ".$data->system." AND pl_planet =  ".$data->planet;				$result=$this->db->query($q);				$bla = 0;		$html = 'nicht gefunden';				if ($this->db->get_last_num_rows() > 0)		{ 			while ($row = mysql_fetch_array($result, MYSQL_ASSOC)) 			{				$html = $row['pl_spieler'];			}		}				$resultData = new stdClass;		$resultData->html = $html;		$resultData->player = $html;				return new DataResponse(ResultTypes::resultOK,"getPlayerByPlanet",$resultData);	}		public function getPlanetByPlayer($data)	{		$q = "SELECT CONCAT(  `pl_galaxie` ,  ':',  `pl_system` ,  ':',  `pl_planet` ) AS Planet,pl_name from planeten where pl_spieler = '".$data->player."' order by pl_galaxie,pl_system,pl_planet";				$result=$this->db->query($q);				$bla = 0;		$html = '';				if (isset($data->highscore) && $data->highscore)		{			$hi = new HighscoreInterface();			$hs = $hi->getCompleteHighscore($data);			$html .= $hs->data->html;		}				$html .= '<table class="auswertung"><tr><th>Planet</th><th>Name</th></tr>';				if ($this->db->get_last_num_rows() > 0)		{ 			while ($row = mysql_fetch_array($result, MYSQL_ASSOC)) 			{				$bla++;								$html .= '<tr>';								foreach($row as $key => $value)				{					preg_match("/([0-9]+):([0-9]+):([0-9]+)/",$row['Planet'],$planet);					if ($key == 'Planet')					{						$html .= '<td><a href="http://uni1.gigrawars.de/galaxie.php?to='.$value.'">'.$value.'</a>';						$html .= '<div title="Details: '.$row['Planet'].'" class="details icon" onclick="ajaxMessageBox(\'FarmInterface\',\'getFarmData\',{ galaxy:'.$planet[1].',system:'.$planet[2].',planet:'.$planet[3].', highscore: true })"></div></td>';					}					else 					{						$html .= '<td>'.$value.'</td>';					}											}				$html .= '</tr>';									if ($bla%30==29) 				{					$html .= '<tr>'.					'		<th>Planet</th>'.					'		<th>Name</th>'.					'	</tr>';				}			}		}		else		{			$html .= '<tr><td colspan="3">Nicht genug Daten gesammelt!</td></tr>';		}		$html .= '</table>';				$resultData = new stdClass;		$resultData->html = $html;		$resultData->title = $data->player;				return new DataResponse(ResultTypes::resultOK,"getAllPlanets",$resultData);	}		public function getAllPlanets($data)	{		$where = " ";		if (isset($data->galaxy) && ($data->galaxy != ""))		{			$where .= "where pl_galaxie = ".$data->galaxy." ";		}		if (isset($data->system) && ($data->system != ""))		{			$where .= ($where == " " ? "where" : "and")." pl_system = ".$data->system." ";		}						$q = "SELECT CONCAT(  `pl_galaxie` ,  ':',  `pl_system` ,  ':',  `pl_planet` ) AS Planet,pl_name,pl_spieler from planeten".$where."order by pl_galaxie,pl_system,pl_planet";				$result=$this->db->query($q);				$bla = 0;				$html = '<table class="auswertung"><tr><th>Planet</th><th>Name</th><th>Spieler</th></tr>';				if ($this->db->get_last_num_rows() > 0)		{ 			while ($row = mysql_fetch_array($result, MYSQL_ASSOC)) 			{				$bla++;
				
				$html .= '<tr>';
								foreach($row as $key => $value)				{					preg_match("/([0-9]+):([0-9]+):([0-9]+)/",$row['Planet'],$planet);					if ($key == 'pl_spieler')					{						$html .= '<td><a href="http://uni1.gigrawars.de/playercard.php?p='.$row['Planet'].':1">'.$value.'</a>';						$html .= '<div title="Alle Planeten: '.$row['pl_spieler'].'" class="planet icon" onclick="ajaxMessageBox(\'PlanetInterface\',\'getPlanetByPlayer\',{ player:\''.$row['pl_spieler'].'\', highscore: true })"></div></td>';					}					else					if ($key == 'Planet')					{						$html .= '<td><a href="http://uni1.gigrawars.de/galaxie.php?to='.$value.'">'.$value.'</a>';						$html .= '<div title="Details: '.$row['Planet'].'" class="details icon" onclick="ajaxMessageBox(\'FarmInterface\',\'getFarmData\',{ galaxy:'.$planet[1].',system:'.$planet[2].',planet:'.$planet[3].', highscore: true })"></div></td>';											}					else					{						$html .= '<td>'.$value.'</td>';					}										}				$html .= '</tr>';									if ($bla%30==29) 				{					$html .= '<tr>'.					'		<th>Planet</th>'.					'		<th>Name</th>'.					'		<th>Spieler</th>'.					'	</tr>';				}			}		}
		else
		{
			$html .= '<tr><td colspan="3">Nicht genug Daten gesammelt!</td></tr>';
		}		$html .= '</table>';				$resultData = new stdClass;		$resultData->html = $html;				return new DataResponse(ResultTypes::resultOK,"getAllPlanets",$resultData);	}	}PlanetInterface::registerInterface();?>